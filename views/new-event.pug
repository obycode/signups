html
  head
    title Empower4Life Signups - Create Event
    meta(charset="utf-8")
    meta(name="viewport" content="width=device-width, initial-scale=1, user-scalable=no")
    link(rel="stylesheet" href="/assets/css/main.css")
  body(class="landing is-preload")
    - var title = 'New Event';
    include header
    .outer-main
      main
        section(class="Main-content")
          if errors
            .errors
              ul
              each error in errors
                li #{error.msg}

          form.signup(method="POST" action="/admin/event" enctype="multipart/form-data")
            include event-form.pug

            .center
              button(type='submit' class='button-style button-style2') Create Event
    include footer

    script.
      document.addEventListener('DOMContentLoaded', function() {
        const adoptSignupSelect = document.getElementById('adopt_signup');
        const adoptSettings = document.getElementById('adopt-settings');
        const selectAllLink = document.getElementById('select-all-shelters');

        function toggleAdoptSettingsVisibility() {
          if (!adoptSettings) {
            return;
          }
          adoptSettings.style.display = adoptSignupSelect.checked ? 'block' : 'none';
        }

        function getShelterCheckboxes() {
          if (!adoptSettings) {
            return [];
          }
          return Array.from(
            adoptSettings.querySelectorAll('.checkbox-list input[type="checkbox"]')
          );
        }

        function updateSelectAllLabel() {
          if (!selectAllLink) {
            return;
          }
          const checkboxes = getShelterCheckboxes();
          if (checkboxes.length === 0) {
            selectAllLink.textContent = 'Select all';
            return;
          }
          const allChecked = checkboxes.every((checkbox) => checkbox.checked);
          selectAllLink.textContent = allChecked ? 'Clear all' : 'Select all';
        }

        toggleAdoptSettingsVisibility();
        updateSelectAllLabel();

        if (adoptSignupSelect) {
          adoptSignupSelect.addEventListener('change', function() {
            toggleAdoptSettingsVisibility();
          });
        }

        if (selectAllLink) {
          selectAllLink.addEventListener('click', function(event) {
            event.preventDefault();
            const checkboxes = getShelterCheckboxes();
            if (checkboxes.length === 0) {
              return;
            }
            const allChecked = checkboxes.every((checkbox) => checkbox.checked);
            checkboxes.forEach((checkbox) => {
              checkbox.checked = !allChecked;
            });
            updateSelectAllLabel();
          });

          adoptSettings.addEventListener('change', function(event) {
            if (event.target && event.target.matches('input[type="checkbox"]')) {
              updateSelectAllLabel();
            }
          });
        }
      });
